* Encoding: UTF-8.

********************************************************************************
 * SPSS Syntax for the ENA vulnerability classification methodology
 *******************************************************************************
						   

*NOTES:
						   
* This syntax file is based on the vulnerability classification methodology recommended for Essential Needs Assessments. 
* This classification is based on the combination of three indicators: the Economic Capacity to Meet Essential Needs (ECMEN), the Livelihood Coping Index for Essential Needs (LCS-EN), and the Food Consumption Score (FCS). 
*However, the vulnerability classification methodolgy can be adapted based on programme needs. See chapter 6 of the Essential Needs Assessment guidance note for more details.

* The syntax files assumes that ECMEN, LCS-EN, and FCS have already been computed based on standard syntax available in
 github (https://github.com/WFP-VAM/RAMResourcesScripts/tree/main/Indicators). The following variables should have been defined before running this file:
	ECMEN_exclAsst
	ECMEN_exclAsst_SMEB		
	Max_coping_behaviourEN
	FCSCat28 
	FCSCat21 
*/

*------------------------------------------------------------------------------.
* 1. Create temporary variables.
*------------------------------------------------------------------------------.

* Create a categorical variable for ECMEN that informs if a household is above MEB, between MEB and SMEB, or below SMEB.
COMPUTE temp_ECMEN_categ = 0.
IF (ECMEN_exclAsst = 1) temp_ECMEN_categ = 0.
IF (ECMEN_exclAsst = 0 & ECMEN_exclAsst_SMEB = 1) temp_ECMEN_categ = 1.
IF (ECMEN_exclAsst_SMEB = 0) temp_ECMEN_categ = 2.

* Label the values.
VALUE LABELS temp_ECMEN_categ
  2 'below SMEB'
  1 'below MEB and above SMEB'
  0 'above MEB'.

* Declare whether the 21 or 28 threshold is used for FCS.
COMPUTE temp_FCS_categ = FCSCat21 /* ! replace with FCSCat28 if the CO uses 28 threshold ! */.

*------------------------------------------------------------------------------.
* 2. Classify households into vulnerability categories.
*------------------------------------------------------------------------------.

COMPUTE ENA_vulnerability = 3.
IF (temp_ECMEN_categ = 2 | Max_coping_behaviourEN = 4 | temp_FCS_categ = 1) ENA_vulnerability = 3.

IF (temp_ECMEN_categ = 2 & Max_coping_behaviourEN = 4) ENA_vulnerability = 4.
IF (temp_ECMEN_categ = 2 & temp_FCS_categ = 1) ENA_vulnerability = 4.
IF (Max_coping_behaviourEN = 4 & temp_FCS_categ = 1) ENA_vulnerability = 4.

IF (temp_ECMEN_categ = 1 & Max_coping_behaviourEN < 4 & temp_FCS_categ >= 2 & temp_FCS_categ <= 3) ENA_vulnerability = 2.
IF (temp_ECMEN_categ = 0 & Max_coping_behaviourEN = 3 & temp_FCS_categ >= 2 & temp_FCS_categ <= 3) ENA_vulnerability = 2.
IF (temp_ECMEN_categ = 0 & Max_coping_behaviourEN < 3 & temp_FCS_categ = 2) ENA_vulnerability = 2.

IF (temp_ECMEN_categ = 0 & Max_coping_behaviourEN < 3 & temp_FCS_categ = 3) ENA_vulnerability = 1.

* Label the variable.
VALUE LABELS ENA_vulnerability
  1 'Not vulnerable'
  2 'Moderately vulnerable'
  3 'Highly vulnerable'
  4 'Extremely vulnerable'.

* Calculate the population share in vulnerability tiers.
FREQUENCIES ENA_vulnerability.

* Drop unnecessary variables.
DELETE VARIABLES temp_ECMEN_categ temp_FCS_categ.

